/*
 * This Kotlin source file was generated by the Gradle 'init' task.
 */
package example

import container.DependencyInjectionContainer
import example.services.IRandomStringsService
import example.utils.IRandomProvider
import kotlin.test.Test
import kotlin.test.assertEquals

class RandomStringsServiceTest {

  @Test
  fun CanGetRandomStrings() {
    // Arrange
    val container = DependencyInjectionContainer().injectServices()
    container.injectSingleton<IRandomProvider>(TestRandomProvider("<random>"))

    // Act
    val client = container.createClient<IRandomStringsService>()
    val res = client.GetRandomStrings()

    // Assert
    assertEquals(listOf("<random>", "<random>", "<random>"), res)
  }
}

class TestRandomProvider : IRandomProvider {
  private val value: String

  constructor(value: String) {
    this.value = value
  }

  override fun CreateRandomString(): String {
    return this.value
  }
}

inline fun <reified T> DependencyInjectionContainer.createClient(): T where T : Any {
  val scope = this.createScope()
  return scope.provide<T>()
}
